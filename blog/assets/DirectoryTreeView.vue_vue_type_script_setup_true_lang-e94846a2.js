import{d as Q,f as d,g as C,h as b,w as r,i as u,j as $,t as E,F as R,l as F,A as S,k as le,aE as ne,m as oe,G as re,aj as se,_ as de,r as v,c as G,K as ce,z as ie,M as P,N as q,L as ue,D as H,P as pe,Q as me,p as fe,q as ve,v as he,aF as ye,S as _e,O as h}from"./index-31ea285c.js";import{C as Ce}from"./el-tree-04aa848f.js";/* empty css                    *//* empty css                 *//* empty css               *//* empty css               *//* empty css                  */import{M as De,E as _}from"./DirectroyTree-a29405c1.js";/* empty css                */const ge={key:2,class:"tag-area"},ke=Q({__name:"DierctoryTreeNode",props:{data:{}},emits:["double-click","once-click","right-click"],setup(x,{emit:I}){const{data:T}=x,c=I;let D=null;const U=()=>{D=setTimeout(()=>{c("right-click",T)},500)},B=()=>{D!==null&&(clearTimeout(D),D=null)};return(o,i)=>{const y=oe,g=re,k=se;return d(),C("span",{class:"tree-node",onDblclick:i[0]||(i[0]=s=>c("double-click",o.data)),onClick:i[1]||(i[1]=s=>c("once-click",o.data)),onContextmenu:i[2]||(i[2]=ne(s=>c("right-click",o.data),["prevent"])),onTouchstart:U,onTouchend:B,onTouchmove:B},[o.data.detail?(d(),b(g,{key:0,content:o.data.detail,enterable:!1,"show-after":400},{default:r(()=>[u(y,null,{default:r(()=>[$(E(o.data.isDir?"-":"")+E(o.data.label),1)]),_:1})]),_:1},8,["content"])):(d(),b(y,{key:1},{default:r(()=>[$(E(o.data.isDir?"-":"")+E(o.data.label),1)]),_:1})),o.data.tags?(d(),C("div",ge,[(d(!0),C(R,null,F(o.data.tags,s=>(d(),b(k,{key:s,color:S(De).string2color(s)},{default:r(()=>[$(E(s)+"Â ",1)]),_:2},1032,["color"]))),128))])):le("",!0)],32)}}});const Ee=de(ke,[["__scopeId","data-v-d346cfd4"]]),Be=Q({__name:"DirectoryTreeView",props:{data:{},searchData:{},contentMenuData:{},draggable:{type:Boolean},height:{},width:{}},emits:["command","move"],setup(x,{emit:I}){const{data:T,searchData:c,contentMenuData:D,height:U,width:B,draggable:o=!1}=x,i=I,y=v(c.searchType?c.searchType:c.searchTypes[0].value),g=v(c.orderKeys?c.orderKeys[0].value:void 0),k=(t,e,n=!0,f)=>{let p;return n?p=h.filter(t,m=>{let l=h.clone(m);return l.children=l.children?k(l.children,e,n):[],l.expend=s[l.id]??!1,l.children.length||e==""||l.fileName.includes(e)}):p=h.filter(t,m=>{let l=h.clone(m);return l.children=l.children?k(l.children,e,n):[],l.expend=s[l.id]??!1,l.children.length&&l.tags&&(e==""||h.find(l.tags,L=>L.includes(e)))}),p.forEach(m=>m.sortBy(f)),h.sortBy(p,f,"DESC")},s=G({}),X=ce(()=>w.value?k(T,w.value,y.value=="kw",g.value):h.cloneDeep(T)),O=v(null),Y=(t,e)=>{e.expend=!0,s[e.id]=!0},J=(t,e)=>{e.expend=!1,s[e.id]=void 0},K=v(!1),w=v(""),W=t=>{t.key==="Escape"?K.value=!1:t.key.length==1&&(K.value=!0,O.value&&O.value.focus())},Z=t=>{t.preventDefault(),t.stopPropagation(),N.value=!0;let e=t.clientX,n=t.clientY;V.x=e-5,V.y=n-5},N=v(!1),V=G({x:0,y:0}),j=v(null);let z=!0;const M=(t,e)=>{N.value=!1;let n=null;e?(j.value=e,n=e):n=j.value,i("command",t,n),z=t===_.NODE_CLICK},ee=t=>{z&&t.button==0&&i("command",_.NODE_CLICK,void 0,void 0)},te=(t,e,n)=>{var p;let f=!1;return(p=i("move",_.MOVE,t.data,n=="inner"?e.data.id:e.data.parentId))==null||p.then(m=>{m&&(f=!0)}),f};return(t,e)=>{const n=pe,f=me,p=fe,m=ve,l=he,L=ye,ae=_e;return d(),C("div",{style:H({height:t.height,width:t.width}),onKeydown:W,onContextmenu:Z,tabindex:"0"},[ie("div",null,[P(u(l,{ref_key:"searchBarRef",ref:O,modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=a=>w.value=a),placeholder:"Filter keyword"},ue({_:2},[t.searchData.searchTypes.length>1?{name:"prepend",fn:r(()=>[u(f,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=a=>y.value=a),placeholder:"Select",style:{width:"80px"}},{default:r(()=>[(d(!0),C(R,null,F(t.searchData.searchTypes,a=>(d(),b(n,{label:a.label,value:a.value,key:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),key:"0"}:void 0,t.searchData.orderKeys?{name:"append",fn:r(()=>[u(m,null,{default:r(()=>[u(p,{span:12},{default:r(()=>[u(f,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=a=>g.value=a),placeholder:"Select",style:{width:"80px"}},{default:r(()=>[(d(!0),C(R,null,F(t.searchData.orderKeys,a=>(d(),b(n,{label:a.label,value:a.value,key:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),key:"1"}:void 0]),1032,["modelValue"]),[[q,K.value]])]),u(ae,{onMouseup:ee},{default:r(()=>[u(L,{"icon-class":"none",data:X.value,"node-key":"id",draggable:t.draggable,onNodeExpand:Y,onNodeClick:J,"allow-drop":te,"expand-on-click-node":!1,props:{isLeaf:a=>!a.isDir}},{default:r(({data:a})=>[u(Ee,{data:a,onOnceClick:A=>M(S(_).NODE_CLICK,a),onDoubleClick:A=>M(S(_).NODE_DOUBLE_CLICK,a),onRightClick:A=>M(S(_).NODE_RIGHT_CLICK,a)},null,8,["data","onOnceClick","onDoubleClick","onRightClick"])]),_:1},8,["data","draggable","props"]),P(u(Ce,{"content-menu-data":t.contentMenuData,onCommand:M,style:H({left:V.x+"px",top:V.y+"px"}),onMouseleave:e[3]||(e[3]=a=>N.value=!1)},null,8,["content-menu-data","style"]),[[q,N.value]])]),_:1})],36)}}});export{Be as _};
