import{d as z,b as I,r as g,c as F,f as i,h as d,w as a,i as t,A as $,j as c,k as p,t as k,E as o,ab as v,m as B,ac as N,v as Z,ad as D,s as M,aa as T,ae as j,af as H,_ as R}from"./index-31ea285c.js";/* empty css                     *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                */function h(u){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(u).toLowerCase())}function q(u){return/^[a-zA-Z0-9_]{3,20}$/.test(u)}function y(u){return/^.{2,20}$/.test(u)}const G=z({__name:"LoginPage",setup(u){const m=I(),r=g(!0),_=g(!0),e=F({username:"",password:"",passwordConfirm:"",email:"",code:"",captcha:"",isCaptchaChecked:!1}),V=()=>{if(!h(e.email)){o.error("invalid email");return}v.sendEmailCode(e.email).then(()=>{o.success("send success")})},x=()=>{e.isCaptchaChecked=!0},b=()=>{if(!h(e.email)){o.error("invalid email");return}if(!y(e.password)){o.error("invalid password, length of password should be 2-20");return}if(!e.isCaptchaChecked){o.error("please check captcha");return}m.login(e.email,e.password).catch(()=>{o.error("login failed")})},E=()=>{if(!h(e.email)){o.error("invalid email");return}if(!q(e.username)){o.error("invalid username, length of username should be 2-20");return}if(!y(e.password)){o.error("invalid password, length of password should be 2-20");return}if(e.password!=e.passwordConfirm){o.error("password not match");return}if(!e.isCaptchaChecked){o.error("please check captcha");return}if(e.code.length==0){o.error("invalid code");return}v.registerUser(e.username,e.password,e.email,"","",e.code).then(C=>{o.success("register success"),r.value=!0,console.log(C)}).catch(()=>{o.error("register failed")})};return(C,l)=>{const U=B,n=N,f=Z,L=D,w=M,A=T,P=j,S=H;return i(),d(S,{class:"container"},{default:a(()=>[t(P,{title:"Form label alignment","label-position":"left","label-width":"70",style:{"max-width":"460px"}},{default:a(()=>[$(m).token?(i(),d(n,{key:0,label:"状态"},{default:a(()=>[t(U,{type:"success"},{default:a(()=>[c("您已登录")]),_:1})]),_:1})):p("",!0),r.value?p("",!0):(i(),d(n,{key:1,label:"Username"},{default:a(()=>[t(f,{modelValue:e.username,"onUpdate:modelValue":l[0]||(l[0]=s=>e.username=s),style:{width:"200px"}},null,8,["modelValue"])]),_:1})),t(n,{label:"Email"},{default:a(()=>[t(f,{modelValue:e.email,"onUpdate:modelValue":l[1]||(l[1]=s=>e.email=s),style:{width:"200px"}},null,8,["modelValue"])]),_:1}),r.value?(i(),d(n,{key:2,label:"",size:"small"},{default:a(()=>[t(L,{modelValue:_.value,"onUpdate:modelValue":l[2]||(l[2]=s=>_.value=s),"active-text":"use password","inactive-text":"",size:"large"},null,8,["modelValue"])]),_:1})):p("",!0),r.value&&!_.value?p("",!0):(i(),d(n,{key:3,label:"Password"},{default:a(()=>[t(f,{modelValue:e.password,"onUpdate:modelValue":l[3]||(l[3]=s=>e.password=s),"show-password":"",style:{width:"200px"}},null,8,["modelValue"])]),_:1})),r.value?p("",!0):(i(),d(n,{key:4,label:"Confirm"},{default:a(()=>[t(f,{modelValue:e.passwordConfirm,"onUpdate:modelValue":l[4]||(l[4]=s=>e.passwordConfirm=s),"show-password":"",style:{width:"200px"}},null,8,["modelValue"])]),_:1})),r.value&&_.value?p("",!0):(i(),d(n,{key:5,label:"email code"},{default:a(()=>[t(f,{modelValue:e.code,"onUpdate:modelValue":l[5]||(l[5]=s=>e.code=s),style:{width:"200px"}},{append:a(()=>[t(w,{onClick:V},{default:a(()=>[c("send")]),_:1})]),_:1},8,["modelValue"])]),_:1})),t(n,{label:"captcha"},{default:a(()=>[t(w,{onClick:x,type:e.isCaptchaChecked?"success":""},{default:a(()=>[c(k(e.isCaptchaChecked?"checked":"check"),1)]),_:1},8,["type"])]),_:1}),t(n,{label:""},{default:a(()=>[r.value?(i(),d(w,{key:0,style:{width:"150px"},type:"primary",onClick:b},{default:a(()=>[c("Login")]),_:1})):(i(),d(w,{key:1,style:{width:"150px"},type:"primary",onClick:E},{default:a(()=>[c("register")]),_:1}))]),_:1}),t(n,null,{default:a(()=>[t(A,{onClick:l[6]||(l[6]=s=>r.value=!r.value),type:"primary"},{default:a(()=>[c(k(r.value?"register":"login"),1)]),_:1})]),_:1})]),_:1})]),_:1})}}});const Y=R(G,[["__scopeId","data-v-9d401f34"]]);export{Y as default};
