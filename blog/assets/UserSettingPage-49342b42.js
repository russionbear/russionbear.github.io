import{d as P,b as U,c as b,f as V,g as h,i as r,A as d,w as t,j as m,E as u,U as C,ab as x,s as y,v as E,ac as w,ae as F,x as k,_ as M}from"./index-31ea285c.js";/* empty css                  *//* empty css                   *//* empty css                     *//* empty css                 */import{U as S}from"./UserInfoView-50e51eba.js";import{c as p}from"./Cos-0001a053.js";import{c as A}from"./DomUtils-6f7af2dc.js";/* empty css                     *//* empty css                   *//* empty css               *//* empty css                *//* empty css                  */const B={class:"user-setting-container"},z=P({__name:"UserSettingPage",setup(N){const o=U(),e=b({username:o.userInfo.username,personalProfile:o.userInfo.personalProfile,avatar:o.userInfo.avatar,visible:!1}),c=()=>{e.visible=!0,e.username=o.userInfo.username,e.personalProfile=o.userInfo.personalProfile,e.avatar=o.userInfo.avatar},_=()=>{A().then(l=>{if(!l.length)return;const a=l[0];p.createFileMeta(void 0,void 0,void 0,void 0,void 0,a.size).then(s=>{if(!s)throw new Error("create file meta failed");p.uploadFile(s,a).then(n=>{console.log("createFileMeta-result",n),u.success("上传成功"),e.avatar=C.cosUrlPrefix+"/"+s}).catch(n=>{u.error(n.message)})}).catch(s=>{u.error(s.message)})})},v=()=>{const l={userId:o.userInfo.id,username:e.username==o.userInfo.username?void 0:e.username,personalProfile:e.personalProfile==o.userInfo.personalProfile?void 0:e.personalProfile,avatar:e.avatar==o.userInfo.avatar?void 0:e.avatar};x.modifyUserInfo(l).then(()=>{o.refreshUserInfo(),u.success("更新成功"),e.visible=!1}).catch(a=>{u.error(a.message)})};return(l,a)=>{const s=y,n=E,f=w,I=F,g=k;return V(),h("div",B,[r(S,{type:"detail",user:d(o).userInfo,watched:void 0},null,8,["user"]),r(s,{size:"large",onClick:c},{default:t(()=>[m("Modify")]),_:1}),r(g,{center:"","align-center":"",modelValue:e.visible,"onUpdate:modelValue":a[2]||(a[2]=i=>e.visible=i),title:"修改信息"},{footer:t(()=>[r(s,{type:"primary",onClick:v},{default:t(()=>[m("Confirm")]),_:1})]),default:t(()=>[r(I,{"label-width":"80px",model:d(o).userInfo},{default:t(()=>[r(f,{label:"用户名"},{default:t(()=>[r(n,{modelValue:e.username,"onUpdate:modelValue":a[0]||(a[0]=i=>e.username=i)},null,8,["modelValue"])]),_:1}),r(f,{label:"个人简介"},{default:t(()=>[r(n,{modelValue:e.personalProfile,"onUpdate:modelValue":a[1]||(a[1]=i=>e.personalProfile=i)},null,8,["modelValue"])]),_:1}),r(f,{label:"头像"},{default:t(()=>[r(s,{onClick:_},{default:t(()=>[m("Upload")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const X=M(z,[["__scopeId","data-v-92dc2940"]]);export{X as default};
