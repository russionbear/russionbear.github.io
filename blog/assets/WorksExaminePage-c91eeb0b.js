import{G as h}from"./GeneralTable-35001312.js";import{e as s}from"./Examine-bbff49eb.js";import{d as g,a as k,u as f,c as v,r as c,o as w,e as y,f as _,h as S,E as r,a6 as i}from"./index-31ea285c.js";/* empty css                 *//* empty css               *//* empty css                  *//* empty css                    */const M=g({__name:"WorksExaminePage",setup(x){const d=k(),u=f(),e=v({tableKey:Math.random().toString(),total:0,page:1,pageSize:20}),m=c([{label:"id",prop:"id",width:"120",fixed:!0},{label:"邮箱",prop:"userInfo.email",width:"120"},{label:"名称",prop:"fileName",width:"120"},{label:"部分内容",prop:"content"},{label:"创建时间",prop:"insertTime",width:"120"},{label:"更新时间",prop:"updateTime",width:"120"},{label:"是否通过",prop:"approved",width:"120"},{label:"Operations",prop:"operations",width:"160",fixed:"right",operations:[{label:"冻号",cmd:"lock"},{label:"解冻",cmd:"unlock"},{label:"通过",cmd:"pass"},{label:"不通过",cmd:"unpassable"},{label:"查看",cmd:"view"}]}]),n=c([]),b=(l,a)=>{switch(l){case"lock":s.setUnlockTime(a.userId,i().add(7,"days").toDate()).then(t=>{r.success("冻号成功")});break;case"unlock":s.setUnlockTime(a.userId,i().subtract(1,"days").toDate()).then(t=>{r.success("解冻成功")});break;case"pass":s.setWorksApproved(a.id,!0).then(t=>{r.success("成功"),o(e.page)});break;case"unpassable":s.setWorksApproved(a.id,!1).then(t=>{r.success("成功"),o(e.page)});break;case"view":d.push(`/worksbrowser?worksId=${a.id}`);break}},o=l=>{s.listWorks(void 0,l-1,e.pageSize).then(a=>{a.content.forEach(t=>{t.content=t.content.substring(0,128)}),n.value=a.content,e.total=a.totalElements,e.page=a.number+1,e.tableKey=Math.random().toString()})},p=()=>{u.switchPage([])};return w(()=>{p()}),y(()=>{o(e.page),p()}),(l,a)=>(_(),S(h,{"table-key":e.tableKey,columns:m.value,"table-data":n.value,total:e.total,"page-size":e.pageSize,page:e.page,onCommand:b,onPageChange:o},null,8,["table-key","columns","table-data","total","page-size","page"]))}});export{M as default};
