"use strict";(self["webpackChunkadvancedwar_vue"]=self["webpackChunkadvancedwar_vue"]||[]).push([[557,206],{46540:function(e,l,a){a.d(l,{B:function(){return t},f2:function(){return v},N:function(){return o},H$:function(){return f},F0:function(){return b},HG:function(){return g}});var t={};a.r(t),a.d(t,{BActionType:function(){return c},BattleBuildTypes:function(){return d},BattleGeoTypes:function(){return u},BattleLevelTypes:function(){return r},BattleUnitStateTypes:function(){return s},BattleUnitTypes:function(){return i},BattleWeatherTypes:function(){return n},PlayerFlagTypes:function(){return m}});var o={};a.r(o),a.d(o,{C:function(){return p}});const u=["beach","bridge","forest","lake","mountain","plain","road","rocks","sea"],n=["sunny","snow","hot","rainy"],r=["normal",""],d=["city","airport","capital","factory","shipyard","stronghold"],i=["footmen","B2","CV","aagun","battleship","bigtank","missileship","chariot","conveyor","destroyer","fighter","gunnery","helicopter","howitzer","launchV","scout","submarine","tank","thaad","transportship","motorcycle","elite","aew","transport"],s=["loading","bullet","occupy","oil","supplies","diving","stealth"],m=["red","blue","green","yellow"];var c,p;(function(e){e["wait"]="wait",e["attack"]="attack",e["load"]="load",e["occupy"]="occupy",e["supply"]="supply",e["diving"]="diving",e["buy"]="buy",e["sortie"]="sortie",e["boutEnd"]="boutEnd",e["udpateMap"]="updateMap"})(c||(c={})),function(e){e["action"]="action",e["chat"]="chat",e["IupdateRoomSetting"]="updateRoomSetting",e["IgetRoom"]="getRoom",e["IuserChoose"]="userChoose",e["IgetMap"]="getMap",e["IprovideAI"]="provideAI",e["ItimeoutBout"]="timeoutBout",e["IgetRole"]="getRole",e["OmapInfo"]="mapInfo",e["OroomSetting"]="roomSetting",e["Oresult"]="result",e["Orole"]="role",e["OgameBegin"]="gameBegin"}(p||(p={}));const v=20,f=["","tip","warning","lock","kill"],g={reportId:"id",reportDsc:"dsc",reportUrl:"url",time:"time",from:"from",fromName:"name",fromDanger:{tip:0,warning:0,lock:0},fromResultDsc:"",to:"to",toName:"toName",toDanger:{tip:0,warning:0,lock:0},toResultDsc:""},b={blogId:"id",title:"error",authorId:"id",authorName:"",createTime:"2020",updateTime:"2020",kw:[],dsc:"error",good:0,copyright:""}},40089:function(e,l){l.Z=(e,l)=>{const a=e.__vccOpts||e;for(const[t,o]of l)a[t]=o;return a}},15206:function(e,l,a){a.r(l),a.d(l,{default:function(){return f}});var t=a(73396),o=a(44870),u=a(84495),n=a(70678);const r={class:"container",style:{height:"500px"}},d={class:"toolbar"},i=(0,t.Uk)("进入战场"),s=["src"],m=(0,t.Uk)("exit");var c=(0,t.aZ)({name:"EgretView",props:{src:null},setup(e,{emit:l}){const a=e,c=((0,o.iH)(null),(0,n.yj)()),p=(0,o.iH)(a.src),v=(0,o.iH)(!1),f=()=>{u.v&&(console.log(navigator.userAgent.toLowerCase()),v.value?document.exitFullscreen():document.documentElement.requestFullscreen()),v.value=!v.value};return(0,t.bv)((()=>{if("/egret"===c.path){if(!c.query.id)return;p.value="?roomid="+c.query.id}})),(e,l)=>{const a=(0,t.up)("el-button");return(0,t.wg)(),(0,t.iD)("div",r,[(0,t._)("div",d,[(0,t.Wm)(a,{type:"primary",style:{width:"50%"},onClick:f},{default:(0,t.w5)((()=>[i])),_:1})]),v.value?((0,t.wg)(),(0,t.iD)("iframe",{key:0,class:"fullscreen",name:"iframe",src:(0,o.SU)(u.Z).egretUrl+p.value,allow:"fullscreen",frameborder:"0"},"\r\n    ",8,s)):(0,t.kq)("",!0),v.value?((0,t.wg)(),(0,t.j4)(a,{key:1,class:"exit-fullscreen",onClick:l[0]||(l[0]=e=>v.value=!1)},{default:(0,t.w5)((()=>[m])),_:1})):(0,t.kq)("",!0)])}}}),p=a(40089);const v=(0,p.Z)(c,[["__scopeId","data-v-4333aefa"]]);var f=v},33557:function(e,l,a){a.r(l),a.d(l,{default:function(){return b}});var t=a(73396),o=a(87139),u=a(44870),n=a(46540),r=a(18678),d=a(20065),i=a(70678),s=a(84495),m=a(15206);const c={class:"container"},p={key:0};var v=(0,t.aZ)({name:"RoomView",setup(e){const l=(0,d.oR)(),a=(0,i.yj)(),v=(0,i.tv)(),f=(0,u.iH)({mapId:0,mapName:"",mapDsc:"",updateTime:0,version:"",kw:"",playCount:0,authorId:"",authorName:"",roomId:0,ownerId:"",ownerName:"",ownerDsc:"",roomBeginTime:0,users:0}),g=(0,u.iH)({dailyMoney:0,cities:0,bouts:0,fogOpen:!1,weather:"",aiLvl:""}),b=(0,u.qj)([]),w=(0,u.iH)([]),h=(0,u.iH)(!1),y=(0,u.iH)(!1),k=(0,u.iH)(!1),V=(0,u.iH)(!1),C=(0,u.iH)(!0),W=(0,u.iH)();(0,t.bv)((()=>{let e=a.query["id"];void 0!==e&&(r.i0().then((e=>{w.value=Object.keys(e.data)})),r.A4({skip:0,type:"id",value:e}).then((l=>{if(0===l.data["data"].length)return;let a=l.data["data"][0];f.value=a;let t=new WebSocket(s.Z.wsUrl+e);t.addEventListener("message",U),t.addEventListener("open",_),t.addEventListener("close",I),W.value=t})).catch((()=>{r.Rn({skip:0,type:"id",value:e}).then((e=>{if(0===e.data["data"].length)return;let l=e.data["data"][0];f.value=l,V.value=!0}))})))})),(0,t.Ah)((()=>{if(void 0===W)return;let e=W.value;e.removeEventListener("message",U),e.removeEventListener("open",_),e.removeEventListener("close",I)}));const U=e=>{C.value=!1,console.log("fsd",e.data);let l=JSON.parse(e.data);switch(console.log("data",l),l.type){case n.N.C.OroomSetting:S(l);break;case n.N.C.OgameBegin:v.push({path:"/egret",query:{id:f.value.roomId}});break;default:break}C.value=!0},_=()=>{let e=W.value;k.value=!0,console.log("connected"),e.send(JSON.stringify({type:n.N.C.IgetRoom}))},I=()=>{k.value=!1;let e=W.value;e.close()},S=e=>{g.value=e.globalSetting,b.splice(0,b.length,...e.usersInfo),h.value=!e.isPrivate,y.value=e.published,console.log("user update",e.usersInfo,[...b])},B=e=>{if(!T())return;if(!k.value||!C.value)return;let a=W.value,t=b.find((l=>l.flag===e));void 0!==t&&a.send(JSON.stringify({type:n.N.C.IuserChoose,flag:e,hero:t.nowCommander,prepared:t.prepared,token:l.state.userinfo.token}))},H=e=>{B(e)},N=e=>{B(e)},D=e=>{B(e)},O=()=>{if(!T())return;if(!k.value||!C.value)return;let e=W.value,l={type:n.N.C.IupdateRoomSetting,globalSetting:g.value,usersInfo:b,isPrivate:!h.value,published:y.value,ownerDsc:f.value.ownerDsc};0!==b.length&&(l.computers=b.filter((e=>e.isComputer)).map((e=>e.flag))),console.log("change",JSON.stringify(l)),e.send(JSON.stringify(l))},T=()=>null!==l.state.userinfo.token||(v.push({path:"/login"}),!1);return(e,a)=>{const r=(0,t.up)("info-room-vue"),d=(0,t.up)("el-descriptions-item"),i=(0,t.up)("el-input"),v=(0,t.up)("el-descriptions"),C=(0,t.up)("el-input-number"),W=(0,t.up)("el-switch"),U=(0,t.up)("el-option"),_=(0,t.up)("el-select"),I=(0,t.up)("el-image"),S=(0,t.up)("el-button"),B=(0,t.up)("el-space"),T=(0,t.up)("el-scrollbar");return(0,t.wg)(),(0,t.iD)("div",c,[(0,t.Wm)(T,{class:"scroll"},{default:(0,t.w5)((()=>[V.value?(0,t.kq)("",!0):((0,t.wg)(),(0,t.iD)("div",p,[(0,t.Wm)(r,{data:f.value,style:{"justify-content":"flex-start"}},null,8,["data"]),(0,t.Wm)(v,{border:""},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"rest"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(f.value.users),1)])),_:1}),(0,t.Wm)(d,{label:"owner"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(f.value.ownerName),1)])),_:1}),(0,t.Wm)(d,{label:"owner's tip"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{modelValue:f.value.ownerDsc,"onUpdate:modelValue":a[0]||(a[0]=e=>f.value.ownerDsc=e),disabled:y.value,type:"textarea",onChange:O},null,8,["modelValue","disabled"])])),_:1})])),_:1}),(0,t.Wm)(v,{border:""},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"dailyMoney"},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{modelValue:g.value.dailyMoney,"onUpdate:modelValue":a[1]||(a[1]=e=>g.value.dailyMoney=e),size:"small",disabled:y.value,onChange:O},null,8,["modelValue","disabled"])])),_:1}),(0,t.Wm)(d,{label:"cities"},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{modelValue:g.value.cities,"onUpdate:modelValue":a[2]||(a[2]=e=>g.value.cities=e),size:"small",disabled:y.value,onChange:O},null,8,["modelValue","disabled"])])),_:1}),(0,t.Wm)(d,{label:"bouts"},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{modelValue:g.value.bouts,"onUpdate:modelValue":a[3]||(a[3]=e=>g.value.bouts=e),size:"small",disabled:y.value,onChange:O},null,8,["modelValue","disabled"])])),_:1}),(0,t.Wm)(d,{label:"fogOpen"},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{modelValue:g.value.fogOpen,"onUpdate:modelValue":a[4]||(a[4]=e=>g.value.fogOpen=e),disabled:y.value,onChange:O},null,8,["modelValue","disabled"])])),_:1}),(0,t.Wm)(d,{label:"weather"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{disabled:y.value,modelValue:g.value.weather,"onUpdate:modelValue":a[5]||(a[5]=e=>g.value.weather=e),size:"small",onChange:O},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,u.SU)(n.B).BattleWeatherTypes,(e=>((0,t.wg)(),(0,t.j4)(U,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])])),_:1}),(0,t.Wm)(d,{label:"aiLvl"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{disabled:y.value,modelValue:g.value.aiLvl,"onUpdate:modelValue":a[6]||(a[6]=e=>g.value.aiLvl=e),size:"small",onChange:O},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,u.SU)(n.B).BattleLevelTypes,(e=>((0,t.wg)(),(0,t.j4)(U,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(b,(e=>((0,t.wg)(),(0,t.j4)(v,{size:"small",border:"",key:e.flag},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:e.flag},{default:(0,t.w5)((()=>[(0,t.Wm)(B,null,{default:(0,t.w5)((()=>[(0,t.Wm)(I,{class:"header_img",src:e.userId?(0,u.SU)(s.Z).staticUrls.userHeader+e.userHeaderUrl:void 0},null,8,["src"]),(0,t.Wm)(S,{type:"primary",disabled:Boolean(e.isComputer)||void 0!==e.userId&&e.userId!==(0,u.SU)(l).state.userinfo.email,onClick:l=>D(e.flag)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.userName),1)])),_:2},1032,["disabled","onClick"])])),_:2},1024)])),_:2},1032,["label"]),(0,t.Wm)(d,{label:"computer"},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{disabled:y.value,modelValue:e.isComputer,"onUpdate:modelValue":l=>e.isComputer=l,onChange:O},null,8,["disabled","modelValue","onUpdate:modelValue"])])),_:2},1024),(0,t.Wm)(d,{label:"prepared"},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{disabled:Boolean(e.isComputer)||void 0!==e.userId&&e.userId!==(0,u.SU)(l).state.userinfo.email,modelValue:e.prepared,"onUpdate:modelValue":l=>e.prepared=l,onChange:l=>H(e.flag)},null,8,["disabled","modelValue","onUpdate:modelValue","onChange"])])),_:2},1024),(0,t.Wm)(d,{label:"commander"},{default:(0,t.w5)((()=>[(0,t.Wm)(B,null,{default:(0,t.w5)((()=>[(0,t.Wm)(I,{class:"header_img",src:(0,u.SU)(s.Z).staticUrls.commanderHeader+e.nowCommander},null,8,["src"]),(0,t.Wm)(_,{disabled:Boolean(e.isComputer)||void 0!==e.userId&&e.userId!==(0,u.SU)(l).state.userinfo.email,modelValue:e.nowCommander,"onUpdate:modelValue":l=>e.nowCommander=l,class:"m-2",placeholder:"Select",size:"small",onChange:l=>N(e.flag)},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(w.value,(e=>((0,t.wg)(),(0,t.j4)(U,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:2},1032,["disabled","modelValue","onUpdate:modelValue","onChange"])])),_:2},1024)])),_:2},1024),(0,t.Wm)(d,{label:"enemies"})])),_:2},1024)))),128)),(0,t.Wm)(B,{class:"room_opera"},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{disabled:!0,"active-text":"connected",modelValue:k.value,"onUpdate:modelValue":a[7]||(a[7]=e=>k.value=e)},null,8,["modelValue"]),(0,t.Wm)(W,{disabled:y.value,"active-text":"公开","inactive-text":"私有",modelValue:h.value,"onUpdate:modelValue":a[8]||(a[8]=e=>h.value=e),onChange:O},null,8,["disabled","modelValue"]),(0,t.Wm)(W,{disabled:y.value,"active-text":"发布","inactive-text":"未发布",modelValue:y.value,"onUpdate:modelValue":a[9]||(a[9]=e=>y.value=e),onChange:O},null,8,["disabled","modelValue"])])),_:1})])),V.value?((0,t.wg)(),(0,t.j4)(m["default"],{key:1,src:(0,u.SU)(s.Z).egretUrl+"?roomid="+f.value.roomId},null,8,["src"])):(0,t.kq)("",!0)])),_:1})])}}}),f=a(40089);const g=(0,f.Z)(v,[["__scopeId","data-v-35e9b62e"]]);var b=g}}]);
//# sourceMappingURL=557.aed67a72.js.map