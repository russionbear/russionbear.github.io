import{d as C,v as B,l as v,s as L,r as h,a as g,b as c,F as O,g as S,w as V,u as w,x as U,k as A,y,e as f,o as p,h as N,i as D,t as F,f as z}from"./index-095ee474.js";import{i as E}from"./generalConfig-4c4c12a0.js";import{E as P}from"./EditModelInfo-ec09ad9e.js";import{E as _}from"./backend-1e23b029.js";import{E as u,_ as R}from"./localAxios-f87130d1.js";const T={class:"edit-area"},j=C({__name:"EditModelListView",setup(q){const x=A(),r=B(),a=v(new _),l=v([...Array(0).keys()].map(t=>{const e=new _;return e.dsc="dsc",e.username="username",e.name="name",e}));L(()=>{if(r.token==null){x.push("/visit/login");return}u.getAll(r.userid,0).then(t=>{l.splice(0,l.length,...t.data)})});const m=h(!1),s=h(""),b=()=>{if(s.value.replaceAll(" ","").length==0)return;let t="",e="",n=s.value.indexOf(";");n==-1?t=s.value:(t=s.value.substring(0,n),e=s.value.substring(n+1));for(let d of l)if(d.name==t){y({type:"info",message:"repeat name"});return}let o=new _;o.name=t,o.dsc=e,o.userid=r.userid,o.username=r.username,o.value="<a href=>empty</a>",u.insertOne(o).then(d=>{d.data=="1"&&(l.splice(0,0,o),y({type:"success"}))})},k=t=>{u.deleteOne(r.userid,t.name).then(e=>{if(e.data=="1"){for(let n=0;n<l.length;n++)if(l[n].name=t.name){l.splice(n,1);break}}})},M=t=>{for(let e in a)a[e]=t[e];m.value=!0},I=()=>{a.userid==null||a.name==null||u.updateOne(a).then(t=>{if(t.data=="1"){for(let e of l)if(e.name==a.name){e.value=a.value;break}}})};return(t,e)=>{const n=f("el-input"),o=f("v-md-editor"),d=f("el-dialog");return p(),g("div",{class:"container",style:U({width:w(E)?"100%":"50%"})},[c(n,{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=i=>s.value=i),clearable:"",placeholder:"create new one(name and dsc are split by fisrt ';')",onChange:b},null,8,["modelValue"]),(p(!0),g(O,null,S(l,i=>(p(),N(P,{onDelete:k,onEdit:M,"edit-model":i,"can-edit":!0},null,8,["edit-model"]))),256)),c(d,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=i=>m.value=i),width:w(E)?"100%":"60%","show-close":!1},{header:V(()=>[D(F(a.name),1)]),default:V(()=>[z("div",T,[c(o,{onSave:I,modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=i=>a.value=i),height:"500px"},null,8,["modelValue"])])]),_:1},8,["modelValue","width"])],4)}}});const W=R(j,[["__scopeId","data-v-0819e6f8"]]);export{W as default};
