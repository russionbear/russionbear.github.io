import{S as h}from"./StorageInfo-227b32ca.js";import{S as v,U as g,W as k}from"./backend-1e23b029.js";import{d as S,r as c,v as w,l as y,s as I,a as d,f as x,F as m,g as V,x as b,u as B,b as C,k as P,o as i,h as W}from"./index-095ee474.js";import{i as O}from"./generalConfig-4c4c12a0.js";import{U,S as N,W as f,_ as A}from"./localAxios-f87130d1.js";import{M as E}from"./MyLinkTo-0f6fd3a0.js";const L=S({__name:"SelfPageView",setup(M){const l=P(),a=c(new g),u=w(),n=c(!1),o=y([...Array(0).keys()].map(e=>{const t=new v;return t.bookname=" bookname",t.userid="userid",t}));I(()=>{let e=l.currentRoute.value.fullPath.indexOf("?");if(e===-1)return;let t=l.currentRoute.value.fullPath.substring(e+2).split("/");t.length==0||t[0]=="undefined"||U.getOneByName(t[0]).then(s=>{s.data!=null&&(a.value=s.data,N.getAllByName(a.value.username).then(r=>{console.log(r.data),o.splice(0,o.length),o.push(...r.data)}),f.getOne(u.userid,a.value.userid).then(r=>{r.data=="1"&&(n.value=!0)}))})});const _=e=>{l.push(`/visit/noteList?/${e.username}/${e.bookname}`)},p=()=>{if(n.value)f.deleteOne(u.userid,a.value.userid).then(e=>{e.data=="1"&&(n.value=!1)});else{const e=new k;e.userid=u.userid,e.targetid=a.value.userid,f.insertOne(e).then(t=>{t.data=="1"&&(n.value=!0)})}};return(e,t)=>(i(),d(m,null,[x("div",{class:"container",style:b({width:B(O)?"100%":"50%"})},[(i(!0),d(m,null,V(o,s=>(i(),W(h,{onEnter:_,"storage-info":s},null,8,["storage-info"]))),256))],4),C(E,{text:"WATCH"+(n.value?"ED":""),"link-type":"event",bottom:220,onClick:p},null,8,["text"])],64))}});const D=A(L,[["__scopeId","data-v-46e66d4a"]]);export{D as default};
